const data = {
moje: [
    { title: "Rohlík", price: "2 Kč", img: "/image/rohlik.png" },
    { title: "Monster Lewis", price: "30 Kč", img: "/image/monster.png" },
    { title: "Adam", price: "69 Kč", img: "/image/adam.png" },
    { title: "Kinder Maxi", price: "13 Kč", img: "/image/maxi.png" },
    { title: "Kofola", price: "35 Kč", img: "/image/kofola.png" },
    { title: "Lentilky", price: "15 Kč", img: "/image/lentilky.png" },
    { title: "Koblih s nutelou", price: "18 Kč", img: "/image/koblih.png" },
    { title: "Margot", price: "20 Kč", img: "/image/margot.png" },
  ],
  ostatni: [
    { title: "Fidorka", price: "15 Kč", img: "/image/fidorka.png" },
    { title: "Ostatní 2", price: "X Kč", img: "https://via.placeholder.com/300" },
    { title: "Ostatní 3", price: "X Kč", img: "https://via.placeholder.com/300" },
    { title: "Ostatní 4", price: "X Kč", img: "https://via.placeholder.com/300" },
  ],
  sleva: [
    { title: "WC", price: "5 Kč", img: "image/kadibudka.png" },
    { title: "Sleva 2", price: "X Kč", img: "https://via.placeholder.com/300" },
    { title: "Sleva 3", price: "X Kč", img: "https://via.placeholder.com/300" },
    { title: "Sleva 4", price: "X Kč", img: "https://via.placeholder.com/300" },
  ],
  novinka: [
    { title: "Muller milk", price: "30 Kč", img: "/image/dubai.jpg" },
    { title: "Novinka 2", price: "X Kč", img: "https://via.placeholder.com/300" },
    { title: "Novinka 3", price: "X Kč", img: "https://via.placeholder.com/300" },
    { title: "Novinka 4", price: "X Kč", img: "https://via.placeholder.com/300" },
  ],
  svacina: [
    { title: "Toast", price: "30 Kč", img: "/image/toast.jpg" },
    { title: "Bageta šunková", price: "50 Kč", img: "/image/bageta.png" },
    { title: "Donut s jahodovou příchutí", price: "15 Kč", img: "/image/donut.png" },
    { title: "Kuřecí wrap", price: "80 Kč", img: "/image/wrap.png" },
    { title: "Chlebíček", price: "35 Kč", img: "/image/chlebicek.png" },
    { title: "7Days croissant", price: "19 Kč", img: "/image/7days.png" },
    { title: "BeBe Dobré Ráno s mlékem", price: "10 Kč", img: "/image/bebe.png" },
  ],
  sladke: [
    { title: "Kinder Bueno", price: "20 Kč", img: "/image/bueno.png" },
    { title: "Kinder mléčný řey", price: "19 Kč", img: "/image/mliecny-rez.png" },
    { title: "Pribiňáček", price: "19 Kč", img: "/image/Pribinacek.png" },
    { title: "Čoko piškoty", price: "50 Kč", img: "/image/coko-piskot.png" },
    { title: "Corny BIG banán v čokoládě", price: "30 Kč", img: "/image/corny.png" },
    { title: "Zlaté polomáčené", price: "25 Kč", img: "/image/zlatky.png" },
    { title: "Esíčka", price: "45 Kč", img: "image/esicka.png" },
    { title: "Skittles", price: "18 Kč", img: "/image/skittles.png" },
  ],
  slane: [
    { title: "Bohemia Chips solené", price: "30 Kč", img: "/image/bohemia.png" },
    { title: "Bohemia Z pece Sýrové tyčinky", price: "29 Kč", img: "/image/zpecesyr.png" },
    { title: "Bake Rolls Pizza", price: "30 Kč", img: "/image/bakerolls.png" },
    { title: "Snack IT Kabanos", price: "25 Kč", img: "/image/snackit.png" },
    { title: "Dupetky Černý & bílý sezam", price: "25 Kč", img: "/image/dupetky.png" },
    { title: "Vest Precle solené", price: "29 Kč", img: "/image/vest.png" },
    { title: "Pringles Original", price: "75 Kč", img: "/image/pringles.png" },
  ],
napoje: [
    { title: "Pepsi", price: "20 Kč", img: "/image/pepsi.png" },
    { title: "Monster Ultra", price: "30 Kč", img: "/image/ultra.png" },
    { title: "Rajec", price: "12 Kč", img: "image/rajec.png" },
    { title: "Fanta", price: "28 Kč", img: "image/fanta.png" },
      { title: "Monster Ultra Peachy Keen", price: "30 Kč", img: "/image/peach.png" },
    { title: "Coca cola", price: "28 Kč", img: "/image/cola.png" },
    { title: "Vinea", price: "28 Kč", img: "/image/vinea.png" },
    { title: "Toptopic", price: "20 Kč", img: "/image/topic.png" },
  ],
  zmrzlina: [
    { title: "Mrož", price: "18 Kč", img: "/image/mroz.png" },
    { title: "Míša", price: "14 Kč", img: "/image/misatvaroh.png" },
    { title: "Magnum", price: "60 Kč", img: "/image/magnum.png" },
    { title: "Ledňáček", price: "10 Kč", img: "/image/lednacek.png" },
     { title: "Calipo", price: "20 Kč", img: "/image/calipo.png" },
    { title: "Míša Kornout", price: "25 Kč", img: "/image/misakornout.png" },
    { title: "Oreo", price: "50 Kč", img: "/image/oreo.png" },
    { title: "Twister", price: "30 Kč", img: "/image/twister.png" },
  ]

};
function loadCategory(category) {
  const productsDiv = document.getElementById("products");
  productsDiv.innerHTML = "";

  if (!data[category]) {
    productsDiv.innerHTML = "<p>Žádné produkty k zobrazení.</p>";
    return;
  }

  data[category].forEach(product => {
    const col = document.createElement("div");
    col.className = "col-md-3 mb-4";
    col.innerHTML = `
      <div class="card h-100">
        <img src="${product.img}" class="card-img-top product-img" alt="${product.title}">
        <div class="card-body">
          <h5 class="card-title">${product.title}</h5>
          <p class="card-text">${product.price}</p>
          <a  class="btn btn-warning" onclick="addToCart('${product.title}', '${product.price}', '${product.img}')">Koupit</a>
        </div>
      </div>
    `;
    productsDiv.appendChild(col);
  });
}

function addToCart(title, price, img) {
  let cart = JSON.parse(localStorage.getItem("cart")) || [];
  const index = cart.findIndex(p => p.title === title);
  if (index > -1) {
    cart[index].quantity = (cart[index].quantity || 1) + 1;
  } else {
    cart.push({ title, price, img, quantity: 1 });
  }
  localStorage.setItem("cart", JSON.stringify(cart));
  updateCartCount();
}

function updateCartCount() {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  const totalCount = cart.reduce((sum, item) => sum + (item.quantity || 1), 0);
  const countEl = document.getElementById("cart-count");
  if (countEl) countEl.textContent = totalCount;
}

function renderCart() {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  const tableBody = document.getElementById("cart-table-body");
  const totalEl = document.getElementById("total-price");
  if (!tableBody || !totalEl) return;

  tableBody.innerHTML = "";
  let total = 0;

  cart.forEach((item, index) => {
    item.quantity = item.quantity || 1;
    const priceNumber = parseInt(item.price.replace(" Kč", ""));
    const itemTotal = item.quantity * priceNumber;
    total += itemTotal;

    const row = document.createElement("tr");
    row.innerHTML = `
      <td class="td">
        <div class="produkt">
          ${item.title}
          <img src="${item.img}">
        </div>
      </td>
      <td class="td text-center">${item.quantity} ks.</td>
      <td class="td text-center">${itemTotal} Kč</td>
      <td class="td text-center">
        <a class="delete-button" onclick="removeFromCart(${index})" style="text-decoration: none;">
          <img class="icon" src="/images/delete_forever.png">
        </a>
      </td>
    `;
    tableBody.appendChild(row);
  });

  totalEl.textContent = `${total} Kč`;
}

function removeFromCart(index) {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  cart[index].quantity = cart[index].quantity || 1;

  if (cart[index].quantity > 1) {
    cart[index].quantity -= 1;
  } else {
    cart.splice(index, 1);
  }

  localStorage.setItem("cart", JSON.stringify(cart));
  renderCart();
  updateCartCount();
}

function clearCart() {
  if (confirm("Opravdu chcete vysypat celý košík?")) {
    localStorage.removeItem("cart");
    renderCart();
    updateCartCount();
  }
}

window.onload = () => {
  loadCategory('moje');
  updateCartCount();
  renderCart();
};